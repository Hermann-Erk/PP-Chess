<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_05) on Thu Oct 09 22:29:33 CEST 2014 -->
<title>BoardSquaresMouseListener</title>
<meta name="date" content="2014-10-09">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BoardSquaresMouseListener";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BoardSquaresMouseListener.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../org/hermann/controller/ChessActionListener.html" title="class in org.hermann.controller"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/hermann/controller/BoardSquaresMouseListener.html" target="_top">Frames</a></li>
<li><a href="BoardSquaresMouseListener.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.hermann.controller</div>
<h2 title="Class BoardSquaresMouseListener" class="title">Class BoardSquaresMouseListener</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.hermann.controller.BoardSquaresMouseListener</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.awt.event.MouseListener, java.util.EventListener</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">BoardSquaresMouseListener</span>
extends java.lang.Object
implements java.awt.event.MouseListener</pre>
<div class="block">This mouselistener will help us to show possible moves on the board
  when the mouse hovers over a button which contains a chesspiece.
  We'll use the boards .getValidMoves - method to paint possible
  destinations in another color (probably green)</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../org/hermann/view/BoardSquares.html" title="class in org.hermann.view">BoardSquares</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#boardSquares">boardSquares</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private javax.swing.JButton[][]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#squares">squares</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#BoardSquaresMouseListener-org.hermann.model.board.Board-javax.swing.JButton:A:A-org.hermann.view.BoardSquares-">BoardSquaresMouseListener</a></span>(<a href="../../../org/hermann/model/board/Board.html" title="class in org.hermann.model.board">Board</a>&nbsp;board,
                         javax.swing.JButton[][]&nbsp;squares,
                         <a href="../../../org/hermann/view/BoardSquares.html" title="class in org.hermann.view">BoardSquares</a>&nbsp;boardSquares)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#mouseClicked-java.awt.event.MouseEvent-">mouseClicked</a></span>(java.awt.event.MouseEvent&nbsp;e)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#mouseEntered-java.awt.event.MouseEvent-">mouseEntered</a></span>(java.awt.event.MouseEvent&nbsp;e)</code>
<div class="block">So here's another annoying thing:
  Since we made the visualized chessboard an eight by eight grid with
  the gridlayoutmanager, we now need the position of the button in the
  grid.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#mouseExited-java.awt.event.MouseEvent-">mouseExited</a></span>(java.awt.event.MouseEvent&nbsp;e)</code>
<div class="block">When the cursor exits the field, all borders are restored to their default color.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#mousePressed-java.awt.event.MouseEvent-">mousePressed</a></span>(java.awt.event.MouseEvent&nbsp;e)</code>
<div class="block">This method will help us actually move the pieces on the board using the mouse.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/hermann/controller/BoardSquaresMouseListener.html#mouseReleased-java.awt.event.MouseEvent-">mouseReleased</a></span>(java.awt.event.MouseEvent&nbsp;e)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="squares">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>squares</h4>
<pre>private&nbsp;javax.swing.JButton[][] squares</pre>
</li>
</ul>
<a name="boardSquares">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>boardSquares</h4>
<pre>private&nbsp;<a href="../../../org/hermann/view/BoardSquares.html" title="class in org.hermann.view">BoardSquares</a> boardSquares</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BoardSquaresMouseListener-org.hermann.model.board.Board-javax.swing.JButton:A:A-org.hermann.view.BoardSquares-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BoardSquaresMouseListener</h4>
<pre>public&nbsp;BoardSquaresMouseListener(<a href="../../../org/hermann/model/board/Board.html" title="class in org.hermann.model.board">Board</a>&nbsp;board,
                                 javax.swing.JButton[][]&nbsp;squares,
                                 <a href="../../../org/hermann/view/BoardSquares.html" title="class in org.hermann.view">BoardSquares</a>&nbsp;boardSquares)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="mouseEntered-java.awt.event.MouseEvent-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mouseEntered</h4>
<pre>public&nbsp;void&nbsp;mouseEntered(java.awt.event.MouseEvent&nbsp;e)</pre>
<div class="block">So here's another annoying thing:
  Since we made the visualized chessboard an eight by eight grid with
  the gridlayoutmanager, we now need the position of the button in the
  grid. There doesn't seem to be any easy way to access this information
  using .getSource() or .getButton(). Even with .getX() and .getY() we
  only get the mouse coordinates relative to the button, which doesn't
  really help us either.
  I think the easiest way to solve this problem is to use .getSource()
  and then compare the source to every single JButton and then save the
  coordinates in temporary variables.
  
  We also only mark the borders green if there's no piece in focus,
  this will (together with our changes in mouseExited) cause the possible
  moves to stay highlighted until a move with a focused piece is made.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>mouseEntered</code>&nbsp;in interface&nbsp;<code>java.awt.event.MouseListener</code></dd>
</dl>
</li>
</ul>
<a name="mouseExited-java.awt.event.MouseEvent-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mouseExited</h4>
<pre>public&nbsp;void&nbsp;mouseExited(java.awt.event.MouseEvent&nbsp;e)</pre>
<div class="block">When the cursor exits the field, all borders are restored to their default color.
  But we want to keep the green borders for a piece in focus, so we only restore
  all the borders default colors, if there's no current boardFocus in ChessStatics.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>mouseExited</code>&nbsp;in interface&nbsp;<code>java.awt.event.MouseListener</code></dd>
</dl>
</li>
</ul>
<a name="mousePressed-java.awt.event.MouseEvent-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mousePressed</h4>
<pre>public&nbsp;void&nbsp;mousePressed(java.awt.event.MouseEvent&nbsp;e)</pre>
<div class="block">This method will help us actually move the pieces on the board using the mouse.
        
        In order to do that I added a small feature that could be pretty useful and will
  probably make things a lot easier. I gave our ChessStatics class an additional
  static attribute called boardFocus, an integer-array of the size 2.
  
  Now, if we click a piece on the board, its position will be saved as the boardFocus
  and our focused field will be highlighted in blue (background changes). Otherwise
  there would be no easy way to move a piece around, since we need the position of
  the piece we want to move and its destination field on the board and a single mouse
  click can't provide both positions, so we have to temporarily save one of them.
 
        The method basically searches for the source of the event (the right JButton in the
  grid) and then the following action depends on whether there's a piece currently 
  focused:
  
  1. If there's no focus on any piece (boardFocus == null), but a field containing a 
     chess piece has been clicked, the focus is set on that field. (If the field doesn't
     contain a piece the focus stays null)
  
  2. If there's a focused piece, the method checks if the new clicked field is a valid field
     for movement. This time we also have to check, if the king will be put in check.
     However, we can't just use the isKingInCheck method on the board, before we make the move
     and then decide, if we want to make the move or not, because isKingInCheck can only check
     the current state of the board, so we have to make the move first, even if it's invalid,
     then check, if the king is in check and then undo the move, if it wasn't allowed.
     And to be able to do that, we have to make sure to not overwrite pieces and position on
     the board that we can't restore afterwards.
        
     If the move was valid, the static playerTurn in ChessStatics changes to the other player,
     if it was invalid, the player gets another chance to make a valid move.
     In any case, the focus is set back to null and the icons on the board are repainted.
     
        At first I wasn't very comfortable about the idea of checking for invalid movements due to
  the king being in check in our BoardSquaresMouseListener, because it seems to be directly
  related to our isMoveValid methods. However, there are several reasons, why I decided to separate
  this part from our isMoveValid methods:
        
        In order to tell, if the king is currently in check or not, we need to use the boards
        isKingInCheck method. But it is not possible for us to use isKingInCheck within our
        isMoveValid methods, since isKingInCheck calls isMoveValid to obtain the pieces movement
        patterns, using isKingInCheck in isMoveValid would lead to an infinite regress 
        (Endlosrekursion), so we are forced to split up checking the movement patterns and 
        possible attacks on the king.
  
        We also make use of several outputs for the user here (in case of an invalid move due to
        the king being attacked for example), I think message panels like those don't belong into
        the model. I know, it would be possible to put the test, if the particular move puts the
        king in check, in the model and use a return code (true or false) to indicate if we need
        an error message for the user. But I actually think that the test itself doesn't belong
        into the model either, it temporarily saves the piece on the movement destination and then
        puts the piece the player wants to move on that position and only restores the former state,
        if the king is in check (the move is invalid), we move the piece to check if the move itself
        is valid. For me the concrete act of moving a piece is definitely something that belongs into
        our controller package, even if the test for movement validity looks a little odd here.
  
        (This especially applies to castling (Rochade), as we have to move two pieces at once (king and rook)
         which would look very weird, if we put the movement validation below into our model package, it would
         probably resolve in a breach of our MVC model)</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>mousePressed</code>&nbsp;in interface&nbsp;<code>java.awt.event.MouseListener</code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>isCastling</code> - Boolean value that indicates if the player is castling or not.
                                          In case of castling we don't check if the king is in check like
                                          we usually do. Castling is handled separately, because we also
                                          have to move the Rook, otherwise we would have to check if the
                                          castling is valid, then if the king will be put in check and then
                                          we would have to check again if there was castling involved (and in
                                          which direction) to be able to move the rook.</dd>
<dd><code>moveFailed</code> - We need this boolean value to indicate if the move was successful or
                                  not. For instance we need to check if the game is over if the move
                                  hasn't failed</dd>
<dd><code>focusX</code> - The focus is on the piece's position that the player wants to move, it's 
                                  null if there's no piece focused</dd>
<dd><code>x</code> - The horizontal position of the button, which is the event's source
                                          <a href="../../../org/hermann/view/BoardSquares.html" title="class in org.hermann.view"><code>BoardSquares</code></a></dd>
</dl>
</li>
</ul>
<a name="mouseClicked-java.awt.event.MouseEvent-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mouseClicked</h4>
<pre>public&nbsp;void&nbsp;mouseClicked(java.awt.event.MouseEvent&nbsp;e)</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>mouseClicked</code>&nbsp;in interface&nbsp;<code>java.awt.event.MouseListener</code></dd>
</dl>
</li>
</ul>
<a name="mouseReleased-java.awt.event.MouseEvent-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>mouseReleased</h4>
<pre>public&nbsp;void&nbsp;mouseReleased(java.awt.event.MouseEvent&nbsp;e)</pre>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>mouseReleased</code>&nbsp;in interface&nbsp;<code>java.awt.event.MouseListener</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BoardSquaresMouseListener.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../org/hermann/controller/ChessActionListener.html" title="class in org.hermann.controller"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/hermann/controller/BoardSquaresMouseListener.html" target="_top">Frames</a></li>
<li><a href="BoardSquaresMouseListener.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
